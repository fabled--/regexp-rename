このツールは、ツール本体もtestもREADMEもAI 100%で作成されました。この部分のみ人の手によって書かれています。
細かいところは [生成ルール](.windsurf/rules/regexp-rename-tool-rule.md) も参照してください。

# 正規表現リネームツール (Regexp Rename Tool) 操作マニュアル

このツールは、正規表現を使用して複数のファイル名を一括で変更するためのアプリケーションです。
複数の正規表現を組み合わせた「グループ」を作成し、再利用可能なリネーム処理を実現します。

## 設定ファイルの保存場所

設定（正規表現ライブラリ、グループ、ステップ等）は、OS 標準のアプリ設定ディレクトリ配下に `settings.json` として保存されます。

- **Windows 例**: `%APPDATA%\\com.regexp-rename.tool\\settings.json`

## ウィンドウ状態の保存

アプリ終了時にウィンドウの状態（**位置 / サイズ / 最大化状態**）を保存し、次回起動時に復元します。

## CI / Release (GitHub Actions)

このリポジトリには GitHub Actions の workflow を用意しています。

### PR でテストが落ちたらビルドしない

- **対象**: `main` 向け Pull Request
- **workflow**: `.github/workflows/pr-test.yml`
- **内容**:
  - `npm run build`（型チェック含む）
  - `npm test`（Vitest）
  - `cargo test`（src-tauri）

### テストが通ったら Windows でビルドして Release に公開

- **対象**: `v*` のタグ push（例: `v0.2.1`）
- **workflow**: `.github/workflows/release-windows.yml`
- **内容**:
  - 先に `test` ジョブが走り、成功した場合のみ `build-windows` が実行されます（`needs: test`）
  - `tauri-apps/tauri-action` を使って Windows 版の成果物を GitHub Release にアップロードします

#### リリース手順（例）

1. `package.json` / `src-tauri/tauri.conf.json` の `version` を更新
2. タグを作成して push
   - `git tag v0.2.1`
   - `git push origin v0.2.1`

※ Release の作成/アップロードは `GITHUB_TOKEN` を使用します（追加の Secrets は不要）。

## 1. メイン画面 (メイン操作タブ)

日常的なリネーム作業を行う画面です。

### ファイルの追加
- 画面中央の点線枠エリアにファイルをドラッグ＆ドロップします。
- 追加されたファイルはリスト表示され、現在の設定に基づいた「リネーム後の名前」が青字でプレビュー表示されます。

### リネームの実行
- **正規表現グループの選択**: 画面右上のセレクトボックスから、適用したいグループを選択します。「なし」を選択すると、グループ化されていない個別のステップが適用されます。
- **実行**: 「ファイル名を変更」ボタンをクリックすると、実際にファイル名が変更されます。
- **ファイルの削除**: リスト内の各ファイル右側にあるゴミ箱アイコンをクリックすると、そのファイルを対象から外せます。

---

## 2. 正規表現ライブラリ (正規表現タブ)

よく使う正規表現パターンを保存・管理する画面です。

### 新規作成
- 「新規作成」ボタンをクリックします。
- **名前**: パターンの用途（例：「日付を日本語に」）を入力します。
- **検索パターン**: 検索する正規表現（例：`(\d{4})-(\d{2})-(\d{2})`）を入力します。
- **置換文字列**: 置換後の形式（例：`$1年$2月$3日`）を入力します。

### 編集・削除
- 各カードの右上にある鉛筆アイコンで編集、ゴミ箱アイコンでライブラリから削除できます。

### グループへの追加
- カードの右上にある「＋」アイコンをクリックすると、現在選択中のグループにその正規表現をステップとして追加します。

---

## 3. グループ編集 (グループタブ)

複数の正規表現を組み合わせて複雑なリネーム手順を作成します。

### グループの管理
- **追加**: 「グループ追加」ボタンで新しい空のグループを作成します。
- **名前変更/削除**: 現在選択中のグループに対して操作を行います。

### ステップの構成
グループ内には2種類のステップを追加できます：

1. **正規表現の追加**: 青色のセレクトボックスからライブラリの正規表現を選び、「追加」をクリックします。
2. **グループ参照（差し込み）**: 紫色のセレクトボックスから他のグループを選び、「参照追加」をクリックします。
   - これにより、他のグループで定義した手順をそのまま現在のグループ内に取り込めます。
   - 参照先を変更すると、それを使用しているすべてのグループに反映されます。

### ステップの調整
- **有効/無効**: 各ステップのチェックボックスを外すと、そのステップを一時的にスキップできます。
- **削除**: ゴミ箱アイコンでステップを削除します。

---

## Tips: 正規表現のヒント
- `$1`, `$2` ... : 検索パターンの `()` で囲ったグループに対応します。
- `^` : 行の先頭（ファイル名の先頭に文字を追加したい時に便利です）。
- `$` : 行の末尾（拡張子の前に文字を追加したい時に便利です）。
- このツールでは、**拡張子を除いたファイル名本体**に対して正規表現が適用されます。
